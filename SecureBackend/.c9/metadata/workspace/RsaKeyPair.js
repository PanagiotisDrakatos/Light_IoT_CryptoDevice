{"changed":true,"filter":false,"title":"RsaKeyPair.js","tooltip":"/RsaKeyPair.js","value":"'use strict';\n\nvar PromiseInspection = require('bluebird').Promise;\nvar fs = PromiseInspection.promisifyAll(require('fs'));\nvar path = require('path');\nvar ursa = require('ursa');\nvar mkdirpAsync = PromiseInspection.promisify(require('mkdirp'));\n\nmodule.exports.keypair = Keypair;\n\nfunction Keypair(pathname) {\n    var key = ursa.generatePrivateKey(2048, 65537);\n    var privpem = key.toPrivatePem();\n    var pubpem = key.toPublicPem();\n    var privkey = path.join(pathname, 'privkey.pem');\n    var pubkey = path.join(pathname, 'pubkey.pem');\n\n    return mkdirpAsync(pathname).then(function() {\n        return PromiseInspection.all([\n            fs.writeFileAsync(privkey, privpem, 'ascii'), fs.writeFileAsync(pubkey, pubpem, 'ascii')\n        ]);\n    }).then(function() {\n        return key;\n    });\n}\n\nif (require.main === module) {\n    return PromiseInspection.all([\n        Keypair('RsaKeyPairs')\n    ]).then(function(keys) {\n        console.log('generated %d keypairs', keys.length);\n    });\n}\n\nexports.StoreClientPublic = function(pubpem) {\n    PromiseInspection.all([\n        fs.writeFileAsync('./Client/ClientPublicpem.pem', pubpem, 'utf8')\n    ]);\n}\n","undoManager":{"mark":1,"position":-1,"stack":[[{"start":{"row":11,"column":4},"end":{"row":13,"column":3},"action":"insert","lines":["rsa.generateKeyPair({bits: 2048, workers: 2}, function(err, keypair) {","  // keypair.privateKey, keypair.publicKey","});"],"id":3}],[{"start":{"row":10,"column":28},"end":{"row":11,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":11,"column":0},"end":{"row":11,"column":4},"action":"insert","lines":["    "]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":36,"column":8},"end":{"row":36,"column":25},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":63,"mode":"ace/mode/javascript"}},"timestamp":1474015417295}